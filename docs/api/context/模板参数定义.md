# 模板参数定义<a name="ZH-CN_TOPIC_0000002139071917"></a>

## 功能说明<a name="zh-cn_topic_0000001867289945_zh-cn_topic_0000001389787297_section36583473819"></a>

通过以下函数原型进行模板参数ASCENDC\_TPL\_ARGS\_DECL和模板参数组合ASCENDC\_TPL\_ARGS\_SEL（即可使用的模板）的定义。详细内容请参考[Tiling模板编程](zh-cn_topic_0000002399313281.md)。

## 函数原型<a name="zh-cn_topic_0000001867289945_zh-cn_topic_0000001389787297_section13230182415108"></a>

```
// ParamStruct是存放用户设置的模板参数ASCENDC_TPL_ARGS_DECL和模板参数组合ASCENDC_TPL_ARGS_SEL的结构体，用作后续的Tilingkey与模板参数之间的编解码，用户无需关注
struct ParamStruct {
    const char* name;
    uint32_t paramType;
    uint8_t bitWidth;
    std::vector<uint64_t> vals;
    const char* macroType;
    ParamStruct(const char* inName, uint32_t inParamType, uint8_t inBitWidth, std::vector<uint64_t> inVals,
        const char* inMacroType):
        name(inName), paramType(inParamType), bitWidth(inBitWidth), vals(std::move(inVals)),
        macroType(inMacroType) {}
};
using TilingDeclareParams = std::vector<ParamStruct>;
using TilingSelectParams = std::vector<std::vector<ParamStruct>>;

// 模板参数定义相关接口
#define ASCENDC_TPL_DTYPE_DECL(x, ...) ParamStruct{#x, ASCENDC_TPL_DTYPE, ASCENDC_TPL_8_BW, {__VA_ARGS__}, "DECL"}
#define ASCENDC_TPL_DATATYPE_DECL(x, ...) ParamStruct{#x, ASCENDC_TPL_DTYPE, ASCENDC_TPL_8_BW, {__VA_ARGS__}, "DECL"}
#define ASCENDC_TPL_FORMAT_DECL(x, ...) ParamStruct{#x, ASCENDC_TPL_FORMAT, ASCENDC_TPL_8_BW, {__VA_ARGS__}, "DECL"}
#define ASCENDC_TPL_UINT_DECL(x, bw, ...) ParamStruct{#x, ASCENDC_TPL_UINT, bw, {__VA_ARGS__}, "DECL"}
#define ASCENDC_TPL_BOOL_DECL(x, ...) ParamStruct{#x, ASCENDC_TPL_BOOL, ASCENDC_TPL_1_BW, {__VA_ARGS__}, "DECL"}

#define ASCENDC_TPL_DTYPE_SEL(x, ...) ParamStruct{#x, ASCENDC_TPL_DTYPE, ASCENDC_TPL_8_BW, {__VA_ARGS__}, "SEL"}
#define ASCENDC_TPL_DATATYPE_SEL(x, ...) ParamStruct{#x, ASCENDC_TPL_DTYPE, ASCENDC_TPL_8_BW, {__VA_ARGS__}, "SEL"}
#define ASCENDC_TPL_FORMAT_SEL(x, ...) ParamStruct{#x, ASCENDC_TPL_FORMAT, ASCENDC_TPL_8_BW, {__VA_ARGS__}, "SEL"}
#define ASCENDC_TPL_UINT_SEL(x, ...) ParamStruct{#x, ASCENDC_TPL_UINT, 0, {__VA_ARGS__}, "SEL"}
#define ASCENDC_TPL_BOOL_SEL(x, ...) ParamStruct{#x, ASCENDC_TPL_BOOL, ASCENDC_TPL_1_BW, {__VA_ARGS__}, "SEL"}
#define ASCENDC_TPL_KERNEL_TYPE_SEL(...) ParamStruct{"kernel_type", ASCENDC_TPL_KERNEL_TYPE, ASCENDC_TPL_8_BW, {__VA_ARGS__}, "SEL"}
#define ASCENDC_TPL_DETERMINISTIC_SEL(...) ParamStruct{"deterministic", ASCENDC_TPL_DETERMINISTIC, ASCENDC_TPL_1_BW, {__VA_ARGS__}, "SEL"}

#define ASCENDC_TPL_ARGS_DECL(x, ...) static TilingDeclareParams g_tilingDeclareParams{ __VA_ARGS__ }
#define ASCENDC_TPL_ARGS_SEL(...) { __VA_ARGS__}
#define ASCENDC_TPL_SEL(...) static TilingSelectParams g_tilingSelectParams{ __VA_ARGS__ }
```

## 参数说明<a name="zh-cn_topic_0000001867289945_zh-cn_topic_0000001389787297_section75395119104"></a>

**表 1**  Tiling模板参数定义说明

<a name="table167201345111418"></a>
<table><thead align="left"><tr id="row172084511143"><th class="cellrowborder" valign="top" width="31.57315731573157%" id="mcps1.2.4.1.1"><p id="p772024521413"><a name="p772024521413"></a><a name="p772024521413"></a>宏</p>
</th>
<th class="cellrowborder" valign="top" width="20.59205920592059%" id="mcps1.2.4.1.2"><p id="p97205455141"><a name="p97205455141"></a><a name="p97205455141"></a>功能描述</p>
</th>
<th class="cellrowborder" valign="top" width="47.83478347834784%" id="mcps1.2.4.1.3"><p id="p147201454140"><a name="p147201454140"></a><a name="p147201454140"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="row1720345141410"><td class="cellrowborder" valign="top" width="31.57315731573157%" headers="mcps1.2.4.1.1 "><p id="p12720184531419"><a name="p12720184531419"></a><a name="p12720184531419"></a>ASCENDC_TPL_ARGS_DECL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="20.59205920592059%" headers="mcps1.2.4.1.2 "><p id="p0720154516147"><a name="p0720154516147"></a><a name="p0720154516147"></a>用于定义算子的模板参数。</p>
</td>
<td class="cellrowborder" valign="top" width="47.83478347834784%" headers="mcps1.2.4.1.3 "><a name="ul127205457146"></a><a name="ul127205457146"></a><ul id="ul127205457146"><li>args0：表示算子Optype。</li><li>args1-argsn：后续为若干个DTYPE、FORMAT、UINT、BOOL、KERNEL_TYPE的模板参数定义，分别通过ASCENDC_TPL_DTYPE_DECL<span id="ph179891727909"><a name="ph179891727909"></a><a name="ph179891727909"></a>、</span><span id="ph113342285019"><a name="ph113342285019"></a><a name="ph113342285019"></a>ASCENDC_TPL_DATATYPE_DECL</span>、ASCENDC_TPL_FORMAT_DECL、ASCENDC_TPL_UINT_DECL、ASCENDC_TPL_BOOL_DECL，ASCENDC_TPL_KERNEL_TYPE_DECL进行定义。</li></ul>
</td>
</tr>
<tr id="row2720174531419"><td class="cellrowborder" valign="top" width="31.57315731573157%" headers="mcps1.2.4.1.1 "><p id="p5721184561410"><a name="p5721184561410"></a><a name="p5721184561410"></a>ASCENDC_TPL_DTYPE_DECL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="20.59205920592059%" headers="mcps1.2.4.1.2 "><p id="p18721114510142"><a name="p18721114510142"></a><a name="p18721114510142"></a><span id="ph7594321427"><a name="ph7594321427"></a><a name="ph7594321427"></a>自定义DataType</span>类型的模板参数定义。</p>
</td>
<td class="cellrowborder" valign="top" width="47.83478347834784%" headers="mcps1.2.4.1.3 "><a name="ul1972174581413"></a><a name="ul1972174581413"></a><ul id="ul1972174581413"><li>args0：参数名。</li><li>args1-argsn：后续若干个参数为穷举的<span id="ph113751112194412"><a name="ph113751112194412"></a><a name="ph113751112194412"></a>自定义</span><span id="ph129682064310"><a name="ph129682064310"></a><a name="ph129682064310"></a>DataType</span>枚举值。</li></ul>
</td>
</tr>
<tr id="row566914112417"><td class="cellrowborder" valign="top" width="31.57315731573157%" headers="mcps1.2.4.1.1 "><p id="p783034774115"><a name="p783034774115"></a><a name="p783034774115"></a>ASCENDC_TPL_DATATYPE_DECL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="20.59205920592059%" headers="mcps1.2.4.1.2 "><p id="p117171839134220"><a name="p117171839134220"></a><a name="p117171839134220"></a>原生DataType类型的模板参数定义。</p>
</td>
<td class="cellrowborder" valign="top" width="47.83478347834784%" headers="mcps1.2.4.1.3 "><a name="ul142301058431"></a><a name="ul142301058431"></a><ul id="ul142301058431"><li>args0：参数名。</li><li>args1-argsn：存在两种情况，(1)后续若干个参数为穷举的原生DataType选项，(2)对应的输入参数的索引值（使用ASCENDC_TPL_INPUT(x)进行指定，其中x为对应数值）或对应输出参数的索引值（使用ASCENDC_TPL_OUTPUT(x)进行指定，其中x为对应数值），注意：存在多个时，仅第一个生效。</li><li>支持设置的原生DataType选项（当前芯片版本需要支持对应数据类型）<a name="ol4645238104914"></a><a name="ol4645238104914"></a><ol id="ol4645238104914"><li>C_DT_FLOAT</li><li>C_DT_FLOAT16</li><li>C_DT_INT8</li><li>C_DT_INT32</li><li>C_DT_UINT8</li><li>C_DT_INT16</li><li>C_DT_UINT16</li><li>C_DT_UINT32</li><li>C_DT_INT64</li><li>C_DT_UINT64</li><li>C_DT_DOUBLE</li><li>C_DT_BOOL</li><li>C_DT_COMPLEX64</li><li>C_DT_BF16</li><li>C_DT_INT4</li><li>C_DT_UINT1</li><li>C_DT_INT2</li><li>C_DT_COMPLEX32</li><li>C_DT_HIFLOAT8</li><li>C_DT_FLOAT8_E5M2</li><li>C_DT_FLOAT8_E4M3FN</li><li>C_DT_FLOAT4_E2M1</li><li>C_DT_FLOAT4_E1M2</li></ol>
</li></ul>
</td>
</tr>
<tr id="row177211245191419"><td class="cellrowborder" valign="top" width="31.57315731573157%" headers="mcps1.2.4.1.1 "><p id="p117216458142"><a name="p117216458142"></a><a name="p117216458142"></a>ASCENDC_TPL_FORMAT_DECL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="20.59205920592059%" headers="mcps1.2.4.1.2 "><p id="p1468017015118"><a name="p1468017015118"></a><a name="p1468017015118"></a>支持两种模式：</p>
<p id="p18721045121417"><a name="p18721045121417"></a><a name="p18721045121417"></a><span id="ph16998145112"><a name="ph16998145112"></a><a name="ph16998145112"></a>1. 均为</span><span id="ph5411439185015"><a name="ph5411439185015"></a><a name="ph5411439185015"></a>自定义Format</span>类型的模板参数定义。</p>
<p id="p97815368519"><a name="p97815368519"></a><a name="p97815368519"></a>2. 均为原生Format类型的模板参数定义。</p>
</td>
<td class="cellrowborder" valign="top" width="47.83478347834784%" headers="mcps1.2.4.1.3 "><a name="ul13721144581419"></a><a name="ul13721144581419"></a><ul id="ul13721144581419"><li>args0：参数名。</li><li>args1-argsn：存在两种模式</li><li><span id="ph20666921115213"><a name="ph20666921115213"></a><a name="ph20666921115213"></a>1. </span>后续若干个参数为穷举的<span id="ph16718041115014"><a name="ph16718041115014"></a><a name="ph16718041115014"></a>自定义Format</span>枚举值。</li><li>2. 该模式存在两种情况：(1)后续若干个参数为穷举的原生Format选项，(2)对应的输入参数的索引值（使用ASCENDC_TPL_INPUT(x)进行指定，其中x为对应数值）或对应输出参数的索引值（使用ASCENDC_TPL_OUTPUT(x)进行指定，其中x为对应数值），注意：存在多个时，仅第一个生效。</li><li>支持设置的原生Format选项：<a name="ol20502173118531"></a><a name="ol20502173118531"></a><ol id="ol20502173118531"><li>C_FORMAT_NCHW</li><li>C_FORMAT_NHWC</li><li>C_FORMAT_ND</li><li>C_FORMAT_NC1HWC0</li><li>C_FORMAT_FRACTAL_Z</li><li>C_FORMAT_NC1C0HWPAD</li><li>C_FORMAT_NHWC1C0</li><li>C_FORMAT_FSR_NCHW</li><li>C_FORMAT_FRACTAL_DECONV</li><li>C_FORMAT_C1HWNC0</li><li>C_FORMAT_FRACTAL_DECONV_TRANSPOSE</li><li>C_FORMAT_FRACTAL_DECONV_SP_STRIDE_TRANS</li><li>C_FORMAT_NC1HWC0_C04</li><li>C_FORMAT_FRACTAL_Z_C04</li><li>C_FORMAT_CHWN</li><li>C_FORMAT_FRACTAL_DECONV_SP_STRIDE8_TRANS</li><li>C_FORMAT_HWCN</li><li>C_FORMAT_NC1KHKWHWC0</li><li>C_FORMAT_BN_WEIGHT</li><li>C_FORMAT_FILTER_HWCK</li><li>C_FORMAT_HASHTABLE_LOOKUP_LOOKUPS</li><li>C_FORMAT_HASHTABLE_LOOKUP_KEYS</li><li>C_FORMAT_HASHTABLE_LOOKUP_VALUE</li><li>C_FORMAT_HASHTABLE_LOOKUP_OUTPUT</li><li>C_FORMAT_HASHTABLE_LOOKUP_HITS</li><li>C_FORMAT_C1HWNCoC0</li><li>C_FORMAT_MD</li><li>C_FORMAT_NDHWC</li><li>C_FORMAT_FRACTAL_ZZ</li><li>C_FORMAT_FRACTAL_NZ</li><li>C_FORMAT_NCDHW</li><li>C_FORMAT_DHWCN</li><li>C_FORMAT_NDC1HWC0</li><li>C_FORMAT_FRACTAL_Z_3D</li><li>C_FORMAT_CN</li><li>C_FORMAT_NC</li><li>C_FORMAT_DHWNC</li><li>C_FORMAT_FRACTAL_Z_3D_TRANSPOSE</li><li>C_FORMAT_FRACTAL_ZN_LSTM</li><li>C_FORMAT_FRACTAL_Z_G</li><li>C_FORMAT_RESERVED</li><li>C_FORMAT_ALL</li><li>C_FORMAT_NULL</li><li>C_FORMAT_ND_RNN_BIAS</li><li>C_FORMAT_FRACTAL_ZN_RNN</li><li>C_FORMAT_NYUV</li><li>C_FORMAT_NYUV_A</li><li>C_FORMAT_NCL</li><li>C_FORMAT_FRACTAL_Z_WINO</li><li>C_FORMAT_C1HWC0</li><li>C_FORMAT_FRACTAL_NZ_C0_16</li><li>C_FORMAT_FRACTAL_NZ_C0_32</li><li>C_FORMAT_FRACTAL_NZ_C0_2</li><li>C_FORMAT_FRACTAL_NZ_C0_4</li><li>C_FORMAT_FRACTAL_NZ_C0_8</li></ol>
</li></ul>
</td>
</tr>
<tr id="row2721134518149"><td class="cellrowborder" valign="top" width="31.57315731573157%" headers="mcps1.2.4.1.1 "><p id="p2721194561419"><a name="p2721194561419"></a><a name="p2721194561419"></a>ASCENDC_TPL_UINT_DECL(args0, args1, args2, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="20.59205920592059%" headers="mcps1.2.4.1.2 "><p id="p147211045141416"><a name="p147211045141416"></a><a name="p147211045141416"></a>自定义UINT类型（无符号整形）的模板参数定义。</p>
</td>
<td class="cellrowborder" valign="top" width="47.83478347834784%" headers="mcps1.2.4.1.3 "><a name="ul67211745111418"></a><a name="ul67211745111418"></a><ul id="ul67211745111418"><li>args0：参数名。</li><li>args1：最大位宽，模板参数的个数不能超过最大位宽。</li><li>args2：参数定义的模式。支持以下三种模式：<a name="ul12721114518144"></a><a name="ul12721114518144"></a><ul id="ul12721114518144"><li>ASCENDC_TPL_UI_RANGE：范围模式，设置该模式，后续紧跟着第一个值表示范围个数，第一个值后面的每两个数值为一组分别表示该范围的起、终位置；注意定义的范围个数要和后续的组数保持一致。<p id="p19321105417342"><a name="p19321105417342"></a><a name="p19321105417342"></a><strong id="b14721114521418"><a name="b14721114521418"></a><a name="b14721114521418"></a>举例：</strong>ASCENDC_TPL_UINT_DECL(args0, args1,ASCENDC_TPL_UI_RANGE,2,0,2,3,5)表示2组参数，这2组参数范围为{0, 2}，{3, 5}，因此该参数定义的UINT参数合法值为{0, 1, 2, 3, 4, 5}。</p>
</li><li>ASCENDC_TPL_UI_LIST：穷举模式，设置该模式，则表示后续将穷举出所有的参数值。<p id="p3291227105412"><a name="p3291227105412"></a><a name="p3291227105412"></a><strong id="b127221345121417"><a name="b127221345121417"></a><a name="b127221345121417"></a>举例：</strong>ASCENDC_TPL_UINT_DECL(args0, args1,ASCENDC_TPL_UI_LIST,10,12,13,9,8,7,6)表示1组穷举参数，[10, 12, 13, 9, 8, 7, 6]为穷举值，因此该参数定义的UINT参数合法值为{10, 12, 13, 9, 8, 7, 6}。</p>
</li><li>ASCENDC_TPL_UI_MIX：混合模式，设置该模式，则表示前n个数值为范围模式的参数定义，后m个数值为穷举模式的参数定义。<p id="p1072284512145"><a name="p1072284512145"></a><a name="p1072284512145"></a><strong id="b2072234531415"><a name="b2072234531415"></a><a name="b2072234531415"></a>举例</strong>：</p>
<p id="p127221945111417"><a name="p127221945111417"></a><a name="p127221945111417"></a>ASCENDC_TPL_UINT_DECL(args0, args1,ASCENDC_TPL_UI_MIX,2,0,2,3, 5, 10, 12, 13, 9, 8)表示2组穷举参数，这2组范围为{0, 2}, {3, 5}，[10, 12, 13, 9, 8]为穷举值，因此该参数定义的UINT参数合法值为{0, 1, 2, 3, 4, 5,  10, 12, 13, 9, 8}。</p>
</li></ul>
</li><li>args3-argsn：对应不同范围模式的参数数值。</li></ul>
</td>
</tr>
<tr id="row197225458147"><td class="cellrowborder" valign="top" width="31.57315731573157%" headers="mcps1.2.4.1.1 "><p id="p0722345131419"><a name="p0722345131419"></a><a name="p0722345131419"></a>ASCENDC_TPL_BOOL_DECL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="20.59205920592059%" headers="mcps1.2.4.1.2 "><p id="p3722545151411"><a name="p3722545151411"></a><a name="p3722545151411"></a>自定义bool类型的模板参数定义。</p>
</td>
<td class="cellrowborder" valign="top" width="47.83478347834784%" headers="mcps1.2.4.1.3 "><p id="p872284541413"><a name="p872284541413"></a><a name="p872284541413"></a>args0：参数名。</p>
<p id="p27221345121418"><a name="p27221345121418"></a><a name="p27221345121418"></a>args1-args2：取值范围0，1。</p>
</td>
</tr>
<tr id="row17351183522212"><td class="cellrowborder" valign="top" width="31.57315731573157%" headers="mcps1.2.4.1.1 "><p id="p18352143518225"><a name="p18352143518225"></a><a name="p18352143518225"></a>ASCENDC_TPL_KERNEL_TYPE_DECL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="20.59205920592059%" headers="mcps1.2.4.1.2 "><p id="p1435293519223"><a name="p1435293519223"></a><a name="p1435293519223"></a>定义算子模板参数的kernel类型</p>
</td>
<td class="cellrowborder" valign="top" width="47.83478347834784%" headers="mcps1.2.4.1.3 "><p id="p4637141672417"><a name="p4637141672417"></a><a name="p4637141672417"></a>args0：参数名</p>
<p id="p06378169245"><a name="p06378169245"></a><a name="p06378169245"></a>args1-argsn：后续为若干kernel类型。</p>
<p id="p195465652615"><a name="p195465652615"></a><a name="p195465652615"></a>当前支持的Kernel类型如下：</p>
<a name="ul2054135610267"></a><a name="ul2054135610267"></a><ul id="ul2054135610267"><li>ASCENDC_TPL_AIV_ONLY // 算子执行时仅启动AI Core上的Vector核</li><li>ASCENDC_TPL_AIC_ONLY // 算子执行时仅启动AI Core上的Cube核</li><li>ASCENDC_TPL_MIX_AIV_1_0 // AIC、AIV混合场景下，算子执行时仅会启动AI Core上的Vector核</li><li>ASCENDC_TPL_MIX_AIC_1_0 // AIC、AIV混合场景下，算子执行时仅会启动AI Core上的Cube核</li><li>ASCENDC_TPL_MIX_AIC_1_1 // AIC、AIV混合场景下，算子执行时会同时启动AI Core上的Cube核和Vector核，比例为1：1</li><li>ASCENDC_TPL_MIX_AIC_1_2 // AIC、AIV混合场景下，算子执行时会同时启动AI Core上的Cube核和Vector核，比例为1：2</li><li>ASCENDC_TPL_AICORE // 算子执行时仅会启动AI Core</li><li>ASCENDC_TPL_VECTORCORE // 该参数为预留参数，当前版本暂不支持</li><li>ASCENDC_TPL_MIX_AICORE  //  该参数为预留参数，当前版本暂不支持</li><li>ASCENDC_TPL_MIX_VECTOR_CORE // 算子执行时会同时启动AI Core和Vector Core</li></ul>
</td>
</tr>
</tbody>
</table>

**表 2**  Tiling模板参数组合定义

<a name="table15722174518143"></a>
<table><thead align="left"><tr id="row1172244519146"><th class="cellrowborder" valign="top" width="23.75237523752375%" id="mcps1.2.4.1.1"><p id="p1372215455141"><a name="p1372215455141"></a><a name="p1372215455141"></a>宏</p>
</th>
<th class="cellrowborder" valign="top" width="28.202820282028203%" id="mcps1.2.4.1.2"><p id="p972217453140"><a name="p972217453140"></a><a name="p972217453140"></a>功能描述</p>
</th>
<th class="cellrowborder" valign="top" width="48.04480448044804%" id="mcps1.2.4.1.3"><p id="p12722104513145"><a name="p12722104513145"></a><a name="p12722104513145"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="row9722194518143"><td class="cellrowborder" valign="top" width="23.75237523752375%" headers="mcps1.2.4.1.1 "><p id="p117221445101413"><a name="p117221445101413"></a><a name="p117221445101413"></a>ASCENDC_TPL_SEL(...)</p>
</td>
<td class="cellrowborder" valign="top" width="28.202820282028203%" headers="mcps1.2.4.1.2 "><p id="p167231445161410"><a name="p167231445161410"></a><a name="p167231445161410"></a>算子的模板参数整体组合。</p>
</td>
<td class="cellrowborder" valign="top" width="48.04480448044804%" headers="mcps1.2.4.1.3 "><p id="p11723104571417"><a name="p11723104571417"></a><a name="p11723104571417"></a>包含多个算子的模板参数组合。</p>
</td>
</tr>
<tr id="row13723945181410"><td class="cellrowborder" valign="top" width="23.75237523752375%" headers="mcps1.2.4.1.1 "><p id="p1872354513149"><a name="p1872354513149"></a><a name="p1872354513149"></a>ASCENDC_TPL_ARGS_SEL(...)</p>
</td>
<td class="cellrowborder" valign="top" width="28.202820282028203%" headers="mcps1.2.4.1.2 "><p id="p072304514148"><a name="p072304514148"></a><a name="p072304514148"></a>算子的模板参数组合。</p>
</td>
<td class="cellrowborder" valign="top" width="48.04480448044804%" headers="mcps1.2.4.1.3 "><p id="p9723134510149"><a name="p9723134510149"></a><a name="p9723134510149"></a>一个算子的模板参数组合。</p>
</td>
</tr>
<tr id="row9443131565713"><td class="cellrowborder" valign="top" width="23.75237523752375%" headers="mcps1.2.4.1.1 "><p id="p52843445011"><a name="p52843445011"></a><a name="p52843445011"></a>ASCENDC_TPL_KERNEL_TYPE_SEL(args0)</p>
</td>
<td class="cellrowborder" valign="top" width="28.202820282028203%" headers="mcps1.2.4.1.2 "><p id="p17444815195718"><a name="p17444815195718"></a><a name="p17444815195718"></a>用于设置算子模板参数组合的Kernel类型，但该参数并不能作为核函数的模板参数传入。</p>
</td>
<td class="cellrowborder" valign="top" width="48.04480448044804%" headers="mcps1.2.4.1.3 "><p id="p2651142418375"><a name="p2651142418375"></a><a name="p2651142418375"></a>args0：该模板参数组合下，算子的Kernel类型。如不选择将走自动推导流程，ASCENDC_TPL_SEL下的所有算子对于是否选择KernelType需要保持一致。</p>
<p id="p1617912310417"><a name="p1617912310417"></a><a name="p1617912310417"></a>当前支持的Kernel类型如下：</p>
<a name="ul78891930111019"></a><a name="ul78891930111019"></a><ul id="ul78891930111019"><li>ASCENDC_TPL_AIV_ONLY // 算子执行时仅启动AI Core上的Vector核</li><li>ASCENDC_TPL_AIC_ONLY // 算子执行时仅启动AI Core上的Cube核</li><li>ASCENDC_TPL_MIX_AIV_1_0 // AIC、AIV混合场景下，算子执行时仅会启动AI Core上的Vector核</li><li>ASCENDC_TPL_MIX_AIC_1_0 // AIC、AIV混合场景下，算子执行时仅会启动AI Core上的Cube核</li><li>ASCENDC_TPL_MIX_AIC_1_1 // AIC、AIV混合场景下，算子执行时会同时启动AI Core上的Cube核和Vector核，比例为1：1</li><li>ASCENDC_TPL_MIX_AIC_1_2 // AIC、AIV混合场景下，算子执行时会同时启动AI Core上的Cube核和Vector核，比例为1：2</li><li>ASCENDC_TPL_AICORE // 算子执行时仅会启动AI Core</li><li>ASCENDC_TPL_VECTORCORE // 该参数为预留参数，当前版本暂不支持</li><li>ASCENDC_TPL_MIX_AICORE  //  该参数为预留参数，当前版本暂不支持</li><li>ASCENDC_TPL_MIX_VECTOR_CORE // 算子执行时会同时启动AI Core和Vector Core</li></ul>
</td>
</tr>
<tr id="row177231645191418"><td class="cellrowborder" valign="top" width="23.75237523752375%" headers="mcps1.2.4.1.1 "><p id="p1072304515143"><a name="p1072304515143"></a><a name="p1072304515143"></a>ASCENDC_TPL_DTYPE_SEL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="28.202820282028203%" headers="mcps1.2.4.1.2 "><p id="p12723154513148"><a name="p12723154513148"></a><a name="p12723154513148"></a><span id="ph1198652915514"><a name="ph1198652915514"></a><a name="ph1198652915514"></a>自定义</span>DataType类型的模板参数组合。</p>
</td>
<td class="cellrowborder" valign="top" width="48.04480448044804%" headers="mcps1.2.4.1.3 "><a name="ul19723134541416"></a><a name="ul19723134541416"></a><ul id="ul19723134541416"><li>args0：表示参数名。</li><li>args1-argsn ：后续若干个参数为ASCENDC_TPL_DTYPE_DECL中定义的参数范围子集。</li></ul>
</td>
</tr>
<tr id="row8422954195019"><td class="cellrowborder" valign="top" width="23.75237523752375%" headers="mcps1.2.4.1.1 "><p id="p109219811513"><a name="p109219811513"></a><a name="p109219811513"></a>ASCENDC_TPL_DATATYPE_SEL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="28.202820282028203%" headers="mcps1.2.4.1.2 "><p id="p1542313548508"><a name="p1542313548508"></a><a name="p1542313548508"></a><span id="ph166071933175120"><a name="ph166071933175120"></a><a name="ph166071933175120"></a>原生</span><span id="ph18737145015511"><a name="ph18737145015511"></a><a name="ph18737145015511"></a>DataType类型的模板参数组合</span></p>
</td>
<td class="cellrowborder" valign="top" width="48.04480448044804%" headers="mcps1.2.4.1.3 "><a name="ul29326220525"></a><a name="ul29326220525"></a><ul id="ul29326220525"><li>args0：表示参数名。</li><li>args1-argsn ：后续若干个参数为ASCENDC_TPL_DATATYPE_DECL中定义的参数选项范围的子集。</li></ul>
</td>
</tr>
<tr id="row15723144501418"><td class="cellrowborder" valign="top" width="23.75237523752375%" headers="mcps1.2.4.1.1 "><p id="p19723104531414"><a name="p19723104531414"></a><a name="p19723104531414"></a>ASCENDC_TPL_FORMAT_SEL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="28.202820282028203%" headers="mcps1.2.4.1.2 "><p id="p4723124511148"><a name="p4723124511148"></a><a name="p4723124511148"></a>Format类型的模板参数组合。</p>
</td>
<td class="cellrowborder" valign="top" width="48.04480448044804%" headers="mcps1.2.4.1.3 "><a name="ul37234453140"></a><a name="ul37234453140"></a><ul id="ul37234453140"><li>args0：表示参数名。</li><li>args1-argsn：后续若干个参数为ASCENDC_TPL_FORMAT_DECL中定义的参数<span id="ph12887436105218"><a name="ph12887436105218"></a><a name="ph12887436105218"></a>选项</span>范围子集。</li></ul>
</td>
</tr>
<tr id="row177239457144"><td class="cellrowborder" valign="top" width="23.75237523752375%" headers="mcps1.2.4.1.1 "><p id="p1972354521419"><a name="p1972354521419"></a><a name="p1972354521419"></a>ASCENDC_TPL_UINT_SEL(args0, args1, args2, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="28.202820282028203%" headers="mcps1.2.4.1.2 "><p id="p1572311452142"><a name="p1572311452142"></a><a name="p1572311452142"></a>UINT类型的模板参数组合。</p>
</td>
<td class="cellrowborder" valign="top" width="48.04480448044804%" headers="mcps1.2.4.1.3 "><a name="ul1072316455142"></a><a name="ul1072316455142"></a><ul id="ul1072316455142"><li>args0：表示参数名。</li><li>args1：参数定义的模式。支持如下取值：<a name="ul47236454144"></a><a name="ul47236454144"></a><ul id="ul47236454144"><li>ASCENDC_TPL_UI_RANGE：范围模式。</li><li>ASCENDC_TPL_UI_LIST：穷举模式。</li><li>ASCENDC_TPL_UI_MIX：混合模式。</li></ul>
</li><li>args2-argsn：后续若干个参数为ASCENDC_TPL_UINT_DECL中定义的参数范围子集。</li></ul>
<p id="p20724194561410"><a name="p20724194561410"></a><a name="p20724194561410"></a>模式和参数的配置方式参考ASCENDC_TPL_UINT_DECL(args0, args1, args2, ...)。</p>
</td>
</tr>
<tr id="row1172419455142"><td class="cellrowborder" valign="top" width="23.75237523752375%" headers="mcps1.2.4.1.1 "><p id="p1972414551418"><a name="p1972414551418"></a><a name="p1972414551418"></a>ASCENDC_TPL_BOOL_SEL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="28.202820282028203%" headers="mcps1.2.4.1.2 "><p id="p472474591417"><a name="p472474591417"></a><a name="p472474591417"></a>bool类型的模板参数组合。</p>
</td>
<td class="cellrowborder" valign="top" width="48.04480448044804%" headers="mcps1.2.4.1.3 "><p id="p1972434591415"><a name="p1972434591415"></a><a name="p1972434591415"></a>args0：表示参数名。</p>
<p id="p1724184519144"><a name="p1724184519144"></a><a name="p1724184519144"></a>args1-args2 ：后续若干个参数为ASCENDC_TPL_BOOL_DECL定义的参数范围子集。</p>
</td>
</tr>
<tr id="row1479994315586"><td class="cellrowborder" valign="top" width="23.75237523752375%" headers="mcps1.2.4.1.1 "><p id="p2604358145810"><a name="p2604358145810"></a><a name="p2604358145810"></a>ASCENDC_TPL_DETERMINISTIC_SEL(args0)</p>
</td>
<td class="cellrowborder" valign="top" width="28.202820282028203%" headers="mcps1.2.4.1.2 "><p id="p19799174315815"><a name="p19799174315815"></a><a name="p19799174315815"></a>该组模板参数组合是否使能确定性计算</p>
</td>
<td class="cellrowborder" valign="top" width="48.04480448044804%" headers="mcps1.2.4.1.3 "><p id="p8111928839"><a name="p8111928839"></a><a name="p8111928839"></a>args0: 表示参数名， 可选值范围[true, false, 1, 0]，其中[true/1]表示该组模板参数组合使能确定性计算，[false/0]表示该组模板参数组合不使能确定性计算。需要注意，该值不作为算子的模板参数入参，在使能该值编译时，会添加"-DDETERMINISTIC_MODE=1", 同时会生成以"_deterministic"结尾的json与.o文件，例如："AddCustomTemplate_816f04e052850554f4b3cacb35f8e8c6_deterministic.json"/"AddCustomTemplate_816f04e052850554f4b3cacb35f8e8c6_deterministic.o"</p>
</td>
</tr>
<tr id="row125414102715"><td class="cellrowborder" valign="top" width="23.75237523752375%" headers="mcps1.2.4.1.1 "><p id="p1554114112710"><a name="p1554114112710"></a><a name="p1554114112710"></a>ASCENDC_TPL_SHARED_KERNEL_TYPE_SEL(args0, ...)</p>
</td>
<td class="cellrowborder" valign="top" width="28.202820282028203%" headers="mcps1.2.4.1.2 "><p id="p5541748279"><a name="p5541748279"></a><a name="p5541748279"></a>设置算子模板参数组合的kernel类型，该参数可以作为核函数的模板参数传入。</p>
</td>
<td class="cellrowborder" valign="top" width="48.04480448044804%" headers="mcps1.2.4.1.3 "><p id="p1663273111272"><a name="p1663273111272"></a><a name="p1663273111272"></a>args0: 参数名</p>
<p id="p1063233192717"><a name="p1063233192717"></a><a name="p1063233192717"></a>args1-argsn: 该模板参数组合下，算子的Kernel类型，后续参数为若干kernel类型。该接口不能与ASCENDC_TPL_KERNEL_TYPE_SEL接口同时使用。</p>
</td>
</tr>
</tbody>
</table>

## 返回值说明<a name="zh-cn_topic_0000001867289945_zh-cn_topic_0000001389787297_section25791320141317"></a>

无。

## 约束说明<a name="zh-cn_topic_0000001867289945_zh-cn_topic_0000001389787297_section19165124931511"></a>

对模板参数定义的取值进行修改或新增后，需要重新编译自定义算子包，不能再继续使用之前的算子二进制。

